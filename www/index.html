<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: https: 'unsafe-inline' 'unsafe-eval'; img-src 'self' data: https:; media-src 'self' data: https:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.gstatic.com https://pagead2.googlesyndication.com; style-src 'self' 'unsafe-inline' https:; connect-src 'self' https: data:; font-src 'self' data: https:; frame-src 'self' https:;">
  <title>MyKitchen - Recipe Finder App | Discover Delicious Recipes</title>
  
  <!-- SEO Meta Tags -->
  <meta name="description" content="MyKitchen Recipe Finder - Discover thousands of delicious recipes from around the world. Search Indian, Italian, Mexican, Chinese cuisines and more. Free recipe app with step-by-step cooking instructions.">
  <meta name="keywords" content="recipes, cooking, food, kitchen, Indian recipes, Italian recipes, Mexican food, Chinese cuisine, recipe finder, cooking app, free recipes">
  <meta name="author" content="MyKitchen Recipe App">
  <meta name="robots" content="index, follow">
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="MyKitchen - Recipe Finder App | Discover Delicious Recipes">
  <meta property="og:description" content="Discover thousands of delicious recipes from around the world. Search Indian, Italian, Mexican, Chinese cuisines and more.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://your-domain.com">
  <meta property="og:image" content="https://your-domain.com/recipe-app-preview.jpg">
  <meta property="og:site_name" content="MyKitchen Recipe Finder">
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="MyKitchen - Recipe Finder App">
  <meta name="twitter:description" content="Discover thousands of delicious recipes from around the world.">
  <meta name="twitter:image" content="https://your-domain.com/recipe-app-preview.jpg">
  
  <!-- Mobile App Meta Tags -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="MyKitchen">
  <meta name="theme-color" content="#ff7043">
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://your-domain.com">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  
  <!-- Cordova/PhoneGap Script -->
  <script type="text/javascript" src="cordova.js"></script>
  
  <!-- Structured Data for Recipe App -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "MyKitchen Recipe Finder",
    "description": "Discover thousands of delicious recipes from around the world with step-by-step cooking instructions",
    "url": "https://your-domain.com",
    "applicationCategory": "LifestyleApplication",
    "operatingSystem": "All",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Organization",
      "name": "MyKitchen Team"
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "ratingCount": "1250"
    }
  }
  </script>
  <style>
    * { box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; background: #fafafa; color: #333; padding: 0; }
    
    /* Login/Register Modal Styles */
    .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 1000; }
    .modal-content { background: white; padding: 40px; border-radius: 20px; width: 90%; max-width: 400px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
    .modal-content h2 { margin: 0 0 30px 0; color: #ff7043; font-size: 24px; }
    .modal-content input { width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #ddd; border-radius: 25px; font-size: 16px; outline: none; }
    .modal-content input:focus { border-color: #ff7043; }
    .password-container { position: relative; margin: 10px 0; }
    .password-container input { width: 100%; padding: 15px 40px 15px 15px; margin: 0; border: 2px solid #ddd; border-radius: 25px; font-size: 16px; outline: none; }
    .password-container input:focus { border-color: #ff7043; }
    .toggle-eye { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); font-size: 14px; cursor: pointer; user-select: none; padding: 2px; }
    .toggle-eye:hover { opacity: 0.7; }
    
    /* SEO and Accessibility */
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
    
    /* Improve semantic structure */
    main { min-height: 60vh; }
    .search-section { background: #fff3e0; }
    .recipes-section { background: #fafafa; }
    .modal-content button { width: 100%; padding: 15px; background: #ff7043; color: white; border: none; border-radius: 25px; font-size: 16px; font-weight: 600; cursor: pointer; margin: 20px 0 10px 0; }
    .modal-content button:hover { background: #e64a19; }
    .modal-content p { margin: 20px 0 0 0; color: #666; }
    .modal-content a { color: #ff7043; text-decoration: none; font-weight: 600; }
    .modal-content a:hover { text-decoration: underline; }
    
    /* Header with user menu */
    .header-content { display: flex; justify-content: space-between; align-items: center; }
    .user-menu { display: flex; align-items: center; gap: 15px; }
    .user-menu span { color: white; font-weight: 500; }
    #logout-btn { padding: 8px 15px; background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 15px; cursor: pointer; font-size: 14px; }
    #logout-btn:hover { background: rgba(255,255,255,0.3); }
    
    /* AdMob Ad Styling */
    .ad-container { margin: 10px; padding: 8px; background: #f8f8f8; border-radius: 8px; text-align: center; border: 1px solid #e0e0e0; }
    .ad-container ins { display: block !important; min-height: 50px; }
    
    /* Interstitial Ad Overlay */
    .interstitial-ad { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; display: none; align-items: center; justify-content: center; }
    .interstitial-content { background: white; padding: 20px; border-radius: 15px; max-width: 90%; max-height: 80%; text-align: center; position: relative; overflow: hidden; }
    .close-ad { position: absolute; top: 10px; right: 15px; background: #ff7043; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-weight: bold; z-index: 2001; }
    .close-ad:hover { background: #e64a19; }
    .ad-skip-timer { position: absolute; top: 10px; left: 15px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; z-index: 2001; }
    
    /* App Open Ad Overlay */
    .app-open-ad { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #ff7043, #ff5722); z-index: 3000; display: none; align-items: center; justify-content: center; }
    .app-open-content { background: white; padding: 30px; border-radius: 20px; max-width: 95%; max-height: 90%; text-align: center; position: relative; overflow: hidden; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
    .app-open-header { margin-bottom: 20px; }
    .app-open-title { color: #ff7043; font-size: 24px; font-weight: bold; margin: 10px 0; }
    .app-open-subtitle { color: #666; font-size: 14px; margin-bottom: 15px; }
    .app-open-close { position: absolute; top: 15px; right: 20px; background: #ff7043; color: white; border: none; border-radius: 50%; width: 35px; height: 35px; cursor: pointer; font-weight: bold; font-size: 18px; z-index: 3001; }
    .app-open-close:hover { background: #e64a19; }
    .app-open-timer { position: absolute; top: 15px; left: 20px; background: rgba(0,0,0,0.7); color: white; padding: 8px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; z-index: 3001; }
    
    header { background: #ff7043; color: white; padding: 20px 15px; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    header h1 { margin: 0; font-size: 24px; font-weight: 600; }
    #search-box { display: flex; padding: 15px; background: #fff3e0; gap: 10px; }
    #search-box input { flex: 1; padding: 12px 15px; font-size: 16px; border: 1px solid #ddd; border-radius: 25px; outline: none; }
    #search-box input:focus { border-color: #ff7043; }
    #search-btn { padding: 12px 20px; background: #ff7043; color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 16px; font-weight: 500; min-width: 80px; }
    #search-btn:hover { background: #e64a19; }
    #search-btn:active { transform: scale(0.98); }
    #recipes { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding: 20px 15px; }
    .card { background: white; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden; transition: transform 0.2s, box-shadow 0.2s; }
    .card:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
    .card:active { transform: scale(0.98); }
    .card img { width: 100%; height: 200px; object-fit: cover; }
    .card-body { padding: 20px; }
    .card-body h3 { margin: 0 0 15px 0; font-size: 18px; font-weight: 600; line-height: 1.3; }
    .card-body button { width: 100%; padding: 12px; border: none; background: #ff7043; color: white; border-radius: 25px; cursor: pointer; font-size: 16px; font-weight: 500; transition: background 0.2s; }
    .card-body button:hover { background: #e64a19; }
    .card-body button:active { transform: scale(0.98); }
    #recipe-detail { padding: 20px 15px; background: white; margin: 15px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    #recipe-detail img { width: 100%; max-height: 300px; object-fit: cover; border-radius: 15px; margin-bottom: 20px; }
    #recipe-detail h2 { margin: 0 0 20px 0; font-size: 24px; font-weight: 600; }
    #recipe-detail h3 { margin: 25px 0 15px 0; font-size: 20px; font-weight: 600; color: #ff7043; }
    #recipe-detail ul { padding-left: 20px; }
    #recipe-detail li { margin-bottom: 8px; line-height: 1.5; }
    #recipe-detail p { line-height: 1.6; font-size: 16px; }
    
    /* Mobile specific optimizations */
    @media (max-width: 768px) {
      #recipes { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; padding: 15px 10px; }
      .card-body { padding: 15px; }
      #recipe-detail { margin: 10px; padding: 15px; }
      header h1 { font-size: 20px; }
      #search-box { padding: 10px; }
      .ad-container { margin: 8px 5px; padding: 5px; }
    }
    
    @media (max-width: 480px) {
      #recipes { grid-template-columns: 1fr; gap: 15px; padding: 10px 5px; }
      .card img { height: 180px; }
      #search-box input { font-size: 16px; /* Prevents zoom on iOS */ }
      #search-box { padding: 8px; }
      .search-section { padding-bottom: 5px; }
      .ad-container { margin: 5px 2px; padding: 3px; }
    }
  </style>
</head>
<body>
  <!-- Google AdMob SDK -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-app-pub-3603600033188923" crossorigin="anonymous"></script>
  
  <!-- Firebase SDK -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCAm3-czRTxdcsNehsOSPs0MPGagODs4zo",
      authDomain: "recipes-app-df6ad.firebaseapp.com",
      databaseURL: "https://recipes-app-df6ad-default-rtdb.firebaseio.com",
      projectId: "recipes-app-df6ad",
      storageBucket: "recipes-app-df6ad.firebasestorage.app",
      messagingSenderId: "774974492859",
      appId: "1:774974492859:web:86b0edae5f4896fca5d99e"
    };
    
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    
    // Make auth available globally
    window.firebaseAuth = auth;
    window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
    window.signInWithEmailAndPassword = signInWithEmailAndPassword;
    window.signOut = signOut;
    window.onAuthStateChanged = onAuthStateChanged;
  </script>
  <!-- Login Modal -->
  <div id="login-modal" class="modal">
    <div class="modal-content">
      <h2>🍳 Welcome to MyKitchen</h2>
      <form id="login-form">
        <input type="email" id="email" placeholder="Email" required>
        <div class="password-container">
          <input type="password" id="password" placeholder="Password" required>
          <span class="toggle-eye" onclick="togglePassword('password')">👁️</span>
        </div>
        <button type="submit">Login</button>
      </form>
      <p>Don't have an account? <a href="#" id="show-register">Sign up</a></p>
    </div>
  </div>

  <!-- Register Modal -->
  <div id="register-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <h2>🍳 Create Account</h2>
      <form id="register-form">
        <input type="text" id="reg-username" placeholder="Display Name" required>
        <input type="email" id="reg-email" placeholder="Email" required>
        <div class="password-container">
          <input type="password" id="reg-password" placeholder="Password" required>
          <span class="toggle-eye" onclick="togglePassword('reg-password')">👁️</span>
        </div>
        <button type="submit">Sign Up</button>
      </form>
      <p>Already have an account? <a href="#" id="show-login">Login</a></p>
    </div>
  </div>

  <!-- Main App -->
  <div id="main-app" style="display: none;">
  <header role="banner">
    <div class="header-content">
      <h1>🍳 MyKitchen - Recipe Finder App</h1>
      <nav class="user-menu" role="navigation" aria-label="User menu">
        <span id="user-name">Welcome!</span>
        <button id="logout-btn" aria-label="Logout">Logout</button>
      </nav>
    </div>
  </header>

  <main role="main">
    <section class="search-section" aria-label="Recipe search">
      <div id="search-box">
        <label for="search" class="sr-only">Search recipes</label>
        <input type="text" id="search" placeholder="Search recipes... (e.g. chicken)" aria-describedby="search-help">
        <button id="search-btn" aria-label="Search recipes">Search</button>
        <div id="search-help" class="sr-only">Type a recipe name, ingredient, or cuisine to find recipes</div>
      </div>
    </section>

    <!-- AdMob Banner Ad -->
    <div class="ad-container" id="banner-ad" aria-label="Advertisement">
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-app-pub-3603600033188923"
           data-ad-slot="9680941403"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </div>

    <section class="recipes-section" aria-label="Recipe results">
      <div id="recipes" role="grid" aria-label="Recipe cards"></div>
      
      <div id="recipe-detail" role="article" aria-label="Recipe details"></div>
    </section>
  </main>
  </div> <!-- End of main-app -->

  <!-- Interstitial Ad Modal -->
  <div class="interstitial-ad" id="interstitial-ad">
    <div class="interstitial-content">
      <div class="ad-skip-timer" id="ad-timer">Ad 5s</div>
      <button class="close-ad" id="close-ad-btn" onclick="closeInterstitialAd()" style="display: none;">&times;</button>
      <ins class="adsbygoogle"
           style="display:block; width: 100%; height: 400px;"
           data-ad-client="ca-app-pub-3603600033188923"
           data-ad-slot="1818709359"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </div>
  </div>

  <!-- App Open Ad Modal -->
  <div class="app-open-ad" id="app-open-ad">
    <div class="app-open-content">
      <div class="app-open-timer" id="app-open-timer">Loading 4s</div>
      <button class="app-open-close" id="app-open-close-btn" onclick="closeAppOpenAd()" style="display: none;">&times;</button>
      <div class="app-open-header">
        <div style="font-size: 48px; margin-bottom: 10px;">🍳</div>
        <div class="app-open-title">Welcome to MyKitchen!</div>
        <div class="app-open-subtitle">Discover amazing recipes from around the world</div>
      </div>
      <ins class="adsbygoogle"
           style="display:block; width: 100%; height: 300px;"
           data-ad-client="ca-app-pub-3603600033188923"
           data-ad-slot="3782527718"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
    </div>
  </div>

  <script>
    // Cordova device ready event
    document.addEventListener('deviceready', onDeviceReady, false);
    
    function onDeviceReady() {
      console.log('Cordova device ready');
      // Initialize app after device is ready
      initializeApp();
    }
    
    // Fallback for browser testing
    if (!window.cordova) {
      document.addEventListener('DOMContentLoaded', initializeApp, false);
    }
    
    function initializeApp() {
      // Wait for Firebase to load
      window.addEventListener('load', () => {
      // Authentication System with Firebase
      const loginModal = document.getElementById("login-modal");
      const registerModal = document.getElementById("register-modal");
      const mainApp = document.getElementById("main-app");
      const loginForm = document.getElementById("login-form");
      const registerForm = document.getElementById("register-form");
      const showRegister = document.getElementById("show-register");
      const showLogin = document.getElementById("show-login");
      const logoutBtn = document.getElementById("logout-btn");
      const userName = document.getElementById("user-name");

      // Monitor authentication state
      window.onAuthStateChanged(window.firebaseAuth, (user) => {
        if (user) {
          // User is signed in - show main app with app open ad
          showMainAppWithAd(user.email.split('@')[0]); // Use email prefix as display name
        } else {
          // User is signed out
          mainApp.style.display = 'none';
          loginModal.style.display = 'flex';
          hasShownAppOpenAd = false; // Reset for next login
        }
      });

      // Switch between login and register
      showRegister.addEventListener('click', (e) => {
        e.preventDefault();
        loginModal.style.display = 'none';
        registerModal.style.display = 'flex';
      });

      showLogin.addEventListener('click', (e) => {
        e.preventDefault();
        registerModal.style.display = 'none';
        loginModal.style.display = 'flex';
      });

      // Register functionality with Firebase
      registerForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('reg-email').value;
        const password = document.getElementById('reg-password').value;
        const displayName = document.getElementById('reg-username').value;

        try {
          await window.createUserWithEmailAndPassword(window.firebaseAuth, email, password);
          alert('Account created successfully!');
          // Firebase auth state change will handle showing main app
        } catch (error) {
          alert(error.message);
        }
      });

      // Login functionality with Firebase
      loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        try {
          await window.signInWithEmailAndPassword(window.firebaseAuth, email, password);
          // Firebase auth state change will handle showing main app
        } catch (error) {
          alert(error.message);
        }
      });

      // Logout functionality with Firebase
      logoutBtn.addEventListener('click', async () => {
        try {
          await window.signOut(window.firebaseAuth);
          // Firebase auth state change will handle hiding main app
        } catch (error) {
          alert(error.message);
        }
      });

      function showMainApp(username) {
        loginModal.style.display = 'none';
        registerModal.style.display = 'none';
        mainApp.style.display = 'block';
        userName.textContent = `Welcome, ${username}!`;
        
        // Load recipes after login
        loadInitialRecipes();
      }

      function loadInitialRecipes() {
        categories.forEach(cat => fetchByCategory(cat));
        cuisines.forEach(cuisine => loadCuisineOnInit(cuisine));
        
        // Initialize AdMob after content loads
        setTimeout(initializeAdMob, 1000);
      }
      
      // AdMob Initialization
      function initializeAdMob() {
        try {
          // Initialize the banner ad
          (adsbygoogle = window.adsbygoogle || []).push({});
          console.log('AdMob banner ad initialized');
        } catch (error) {
          console.log('AdMob initialization error:', error);
        }
      }
      
      // Interstitial Ad Management
      let recipeViewCount = 0;
      let adTimer = 5;
      let timerInterval;
      
      function showInterstitialAd() {
        recipeViewCount++;
        if (recipeViewCount % 3 === 0) { // Show every 3rd recipe view
          const interstitialAd = document.getElementById('interstitial-ad');
          const adTimerElement = document.getElementById('ad-timer');
          const closeBtn = document.getElementById('close-ad-btn');
          
          // Reset timer
          adTimer = 5;
          adTimerElement.textContent = `Ad ${adTimer}s`;
          closeBtn.style.display = 'none';
          
          // Show the ad
          interstitialAd.style.display = 'flex';
          
          // Start countdown timer
          timerInterval = setInterval(() => {
            adTimer--;
            adTimerElement.textContent = `Ad ${adTimer}s`;
            
            if (adTimer <= 0) {
              clearInterval(timerInterval);
              adTimerElement.style.display = 'none';
              closeBtn.style.display = 'block';
            }
          }, 1000);
          
          // Initialize the interstitial ad
          try {
            (adsbygoogle = window.adsbygoogle || []).push({});
          } catch (error) {
            console.log('Interstitial ad initialization error:', error);
          }
        }
      }
      
      // Global function to close interstitial ad
      window.closeInterstitialAd = function() {
        const interstitialAd = document.getElementById('interstitial-ad');
        const adTimerElement = document.getElementById('ad-timer');
        const closeBtn = document.getElementById('close-ad-btn');
        
        clearInterval(timerInterval);
        interstitialAd.style.display = 'none';
        adTimerElement.style.display = 'block';
        closeBtn.style.display = 'none';
      }
      
      // Make showInterstitialAd globally available
      window.showInterstitialAd = showInterstitialAd;
      
      // App Open Ad Management
      let appOpenTimer = 4;
      let appOpenTimerInterval;
      let hasShownAppOpenAd = false;
      
      function showAppOpenAd() {
        if (hasShownAppOpenAd) return; // Only show once per session
        
        const appOpenAd = document.getElementById('app-open-ad');
        const appOpenTimerElement = document.getElementById('app-open-timer');
        const appOpenCloseBtn = document.getElementById('app-open-close-btn');
        
        // Reset timer
        appOpenTimer = 4;
        appOpenTimerElement.textContent = `Loading ${appOpenTimer}s`;
        appOpenCloseBtn.style.display = 'none';
        
        // Show the ad
        appOpenAd.style.display = 'flex';
        hasShownAppOpenAd = true;
        
        // Start countdown timer
        appOpenTimerInterval = setInterval(() => {
          appOpenTimer--;
          if (appOpenTimer > 0) {
            appOpenTimerElement.textContent = `Loading ${appOpenTimer}s`;
          } else {
            clearInterval(appOpenTimerInterval);
            appOpenTimerElement.textContent = 'Ready!';
            appOpenCloseBtn.style.display = 'block';
            
            // Auto-close after 2 more seconds
            setTimeout(() => {
              if (appOpenAd.style.display !== 'none') {
                closeAppOpenAd();
              }
            }, 2000);
          }
        }, 1000);
        
        // Initialize the app open ad
        try {
          (adsbygoogle = window.adsbygoogle || []).push({});
        } catch (error) {
          console.log('App Open ad initialization error:', error);
        }
      }
      
      // Global function to close app open ad
      window.closeAppOpenAd = function() {
        const appOpenAd = document.getElementById('app-open-ad');
        const appOpenTimerElement = document.getElementById('app-open-timer');
        const appOpenCloseBtn = document.getElementById('app-open-close-btn');
        
        clearInterval(appOpenTimerInterval);
        appOpenAd.style.display = 'none';
        appOpenCloseBtn.style.display = 'none';
      }
      
      // Show app open ad when user logs in successfully
      function showMainAppWithAd(username) {
        showMainApp(username);
        
        // Show app open ad after a short delay
        setTimeout(() => {
          showAppOpenAd();
        }, 500);
      }
      
      // Small password visibility toggle function
      window.togglePassword = function(inputId) {
        const passwordInput = document.getElementById(inputId);
        const toggleEye = passwordInput.nextElementSibling;
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          toggleEye.textContent = '🙈'; // see-no-evil monkey (small)
        } else {
          passwordInput.type = 'password';
          toggleEye.textContent = '👁️'; // eye (small)
        }
      };
    }); // End of window load event listener
    } // End of initializeApp function
    // Recipe app functionality (only works after login)
    const recipesDiv = document.getElementById("recipes");
    const detailDiv = document.getElementById("recipe-detail");
    const searchInput = document.getElementById("search");
    const searchBtn = document.getElementById("search-btn");

    // Expanded categories to load more recipes
    const categories = [
      "Seafood", "Chicken", "Beef", "Dessert", "Vegetarian", "Pasta", "Lamb",
      "Pork", "Breakfast", "Side", "Starter", "Vegan", "Miscellaneous",
      "Goat", "Soup", "Rice", "Noodles", "Bread", "Salad", "Sandwich"
    ];

    // Various cuisines to add more diversity
    const cuisines = [
      "Italian", "Mexican", "Indian", "Chinese", "Japanese", "Thai",
      "French", "Greek", "American", "British", "Spanish", "Turkish"
    ];

    async function fetchByCategory(category) {
      const res = await fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?c=${category}`);
      const data = await res.json();
      displayRecipes(data.meals, true);
    }

    async function fetchByCuisine(cuisine) {
      const res = await fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?a=${cuisine}`);
      const data = await res.json();
      displayRecipes(data.meals, false); // Don't append when called directly
    }

    async function loadCuisineOnInit(cuisine) {
      const res = await fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?a=${cuisine}`);
      const data = await res.json();
      displayRecipes(data.meals, true); // Append during initialization
    }

    async function fetchRecipes(query = "chicken") {
      // Check if user is searching for Indian dishes
      if (query.toLowerCase().includes('indian')) {
        await fetchByCuisine('Indian');
        return;
      }
      
      const res = await fetch(`https://www.themealdb.com/api/json/v1/1/search.php?s=${query}`);
      const data = await res.json();
      displayRecipes(data.meals);
    }

    function displayRecipes(meals, append = false) {
      if (!append) recipesDiv.innerHTML = "";
      detailDiv.innerHTML = "";
      if (!meals) {
        return;
      }
      meals.forEach(meal => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
          <div class="card-body">
            <h3>${meal.strMeal}</h3>
            <button onclick="showDetail(${meal.idMeal})">View Recipe</button>
          </div>
        `;
        recipesDiv.appendChild(card);
      });
    }

    async function showDetail(id) {
      const res = await fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${id}`);
      const data = await res.json();
      const meal = data.meals[0];

      detailDiv.innerHTML = `
        <h2>${meal.strMeal}</h2>
        <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
        ${meal.strSource ? `<div style="margin: 15px 0;"><a href="${meal.strSource}" target="_blank" style="background: #ff7043; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">🔗 View Original Recipe</a></div>` : ''}
        <h3>Ingredients:</h3>
        <ul>
          ${getIngredients(meal).map(ing => `<li>${ing}</li>`).join("")}
        </ul>
        <h3>Instructions:</h3>
        <p>${meal.strInstructions}</p>
      `;
      window.scrollTo({ top: detailDiv.offsetTop, behavior: 'smooth' });
      
      // Show interstitial ad after viewing recipe details
      if (window.showInterstitialAd) {
        window.showInterstitialAd();
      }
    }

    function getIngredients(meal) {
      let ingredients = [];
      for (let i = 1; i <= 20; i++) {
        let ingredient = meal[`strIngredient${i}`];
        let measure = meal[`strMeasure${i}`];
        if (ingredient && ingredient.trim() !== "") {
          ingredients.push(`${ingredient} - ${measure}`);
        }
      }
      return ingredients;
    }

    // Event listeners for search (only active after login)
    searchInput.addEventListener("keyup", (e) => {
      if (e.key === "Enter") {
        fetchRecipes(searchInput.value);
      }
    });

    // Search button functionality
    searchBtn.addEventListener("click", () => {
      fetchRecipes(searchInput.value);
    });
  </script>
</body>
</html>
